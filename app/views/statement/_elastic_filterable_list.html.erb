<%
statement_elastic_filterable_list_presenter = StatementElasticFilterableListPresenter.new(
  context: context,
  enable_filters: enable_filters,
  params: params
)
show_speaker_role = true if local_assigns[:show_speaker_role].nil?
show_medium_and_date = true if local_assigns[:show_medium_and_date].nil?
wide_display = true if local_assigns[:wide_display].nil?
%>

<div
  class="row g-10 mt-10"
  data-controller="components--filter"
  data-components--filter-open-cols="col col-12 col-lg-8"
  data-components--filter-close-cols="col col-12"
  data-components--filter-open-label="Skrýt filtry"
  data-components--filter-close-label="Zobrazit filtry"
  data-components--filter-close-empty="true"
>
  <div class="col col-12 col-lg-4">
    <a class="btn w-100" data-action="click->components--filter#toggle" aria-show="true">
      <span class="text-white" data-target="components--filter.label">Zobrazit filtry</span>
    </a>
  </div>
  <div class="col col-12 col-lg-8">
    <div class="d-flex justify-content-end">
      <div class="w-100 mw-350px">
        <input name="q" type="text" class="input outline focus-primary" placeholder="Zadejte hledaný výraz…">
      </div>
    </div>
  </div>
  <div class="col col-12 col-lg-4" data-target="components--filter.filter">
    <div class="bg-light rounded-l p-5">
      <% if enable_filters.include?(:tag_id) && statement_elastic_filterable_list_presenter.filter_options[:tag_id].size > 0 %>
        <div class="filter w-100 mb-5">
          <div
            class="filter-link d-flex align-items-center justify-content-between w-100 min-h-40px"
            data-action="click->components--filter#toggleLink"
            data-target="components--filter.filterLink"
            aria-show="true"
          >
            <span class="fs-6 fw-bold">Všechna témata</span>
            <span class="filter-icon">
              <svg width="23" height="12" viewBox="0 0 23 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 0.597656L11.646 11.2437L22.2435 0.646237" stroke="#111827"/>
              </svg>
            </span>
          </div>
          <div class="filter-content" data-target="components--accordion.content">
            <% statement_elastic_filterable_list_presenter.filter_options[:tag_id].each do |filter_option| %>
            <div class="check-btn py-2">
              <input
                type="checkbox"
                data-target="components--filter.filterCheckbox"
                data-action="change->components--filter#toggleFilter"
                data-filter-value="<%= filter_option[:value] %>"
                data-filter-type="politik"
              >
              <span class="checkmark"></span>
              <span class="small fw-bold me-2"><%= filter_option[:label] %></span>
              <span class="smallest min-w-40px"><%= number_with_delimiter(filter_option[:count], delimiter: " ") %> <%= cs_pluralize(filter_option[:count], "výrok", "výroky", "výroků") %></span>
            </div>
            <% end %>
          </div>
        </div>
      <% end %>
      <% if enable_filters.include?(:veracity_key) %>
        <div class="filter w-100 mb-5">
          <div
            class="filter-link d-flex align-items-center justify-content-between w-100 min-h-40px"
            data-action="click->components--filter#toggleLink"
            data-target="components--filter.filterLink"
            aria-show="true"
          >
            <span class="fs-6 fw-bold">Všechna hodnocení</span>
            <span class="filter-icon">
              <svg width="23" height="12" viewBox="0 0 23 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 0.597656L11.646 11.2437L22.2435 0.646237" stroke="#111827"/>
              </svg>
            </span>
          </div>
          <div class="filter-content">
            <% statement_elastic_filterable_list_presenter.filter_options[:veracity_key].each do |filter_option| %>
            <div class="check-btn py-2 <% if filter_option[:count] == 0 %>disabled<% end %>">
              <input
                type="checkbox"
                <% if filter_option[:count] == 0 %>disabled<% end %>
                data-target="components--filter.filterCheckbox"
                data-action="change->components--filter#toggleFilter"
                data-filter-value="<%= filter_option[:value] %>"
                data-filter-type="hodnoceni"
              >
              <span class="checkmark"></span>
              <span class="small fw-bold me-2"><%= filter_option[:label] %></span>
              <span class="smallest min-w-40px"><%= number_with_delimiter(filter_option[:count], delimiter: " ") %> <%= cs_pluralize(filter_option[:count], "výrok", "výroky", "výroků") %></span>
            </div>
            <% end %>
          </div>
        </div>

      <% end %>

      <% if enable_filters.include?(:released_year) && statement_elastic_filterable_list_presenter.filter_options[:released_year].size > 0 %>
        <div class="filter w-100 mb-5">
          <div
            class="filter-link d-flex align-items-center justify-content-between w-100 min-h-40px"
            data-action="click->components--filter#toggleLink"
            data-target="components--filter.filterLink"
            aria-show="true"
          >
            <span class="fs-6 fw-bold">Všechny roky</span>
            <span class="accordion-icon">
              <svg width="23" height="12" viewBox="0 0 23 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 0.597656L11.646 11.2437L22.2435 0.646237" stroke="#111827"/>
              </svg>
            </span>
          </div>
          <div class="filter-content" data-target="components--accordion.content">
            <% statement_elastic_filterable_list_presenter.filter_options[:released_year].each do |filter_option| %>
            <div class="check-btn py-2 <% if filter_option[:count] == 0 %>disabled<% end %>">
              <input
                type="checkbox"
                <% if filter_option[:count] == 0 %>disabled<% end %>
                data-target="components--filter.filterCheckbox"
                data-action="change->components--filter#toggleFilter"
                data-filter-value="<%= filter_option[:value] %>"
                data-filter-type="rok"
              >
              <span class="checkmark"></span>
              <span class="small fw-bold me-2"><%= filter_option[:label] %></span>
              <span class="smallest min-w-40px"><%= number_with_delimiter(filter_option[:count], delimiter: " ") %> <%= cs_pluralize(filter_option[:count], "výrok", "výroky", "výroků") %></span>
            </div>
            <% end %>
          </div>
        </div>
      <% end %>

      <% if enable_filters.include?(:editor_picked) %>
        <div class="mt-5">
          <div class="check-btn py-2 <% if statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:count] == 0 %>disabled<% end %>">
            <input
              type="checkbox"
              <% if statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:selected] %>checked<% end %>
              <% if statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:count] == 0 %>disabled<% end %>
            >
            <span class="checkmark"></span>
            <span class="small fw-bold me-2"><%= statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:label] %></span>
            <span class="smallest min-w-40px"><%= number_with_delimiter(statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:count], delimiter: " ") %> <%= cs_pluralize(statement_elastic_filterable_list_presenter.filter_options[:editor_picked][:count], "výrok", "výroky", "výroků") %></span>
          </div>
        </div>
      <% end %>

      <div class="w-100 mt-5">
        <a class="btn w-100" href="<%= no_filters_url %>">
          <span class="text-white">Zrušit filtry</span>
        </a>
      </div>

    </div>
  </div>
  <div class="col col-12 col-lg-8" data-target="components--filter.content">
    <% statement_elastic_filterable_list_presenter.paginated_statements.each do |statement| %>
      <div>
        <%=
          render(
            partial: "statement/detail",
            object: statement,
            as: :statement,
            locals: { show_speaker_role: show_speaker_role, show_medium_and_date: show_medium_and_date, wide_display: wide_display }
          )
        %>
      </div>
    <% end %>
  </div>
  <div class="col col-12">
    <div class="d-flex justify-content-center mt-5">
        <%= paginate(statement_elastic_filterable_list_presenter.paginated_statements) %>
    </div>
  </div>
</div>
