<% content_for(:title, @article.title) %>
<% @article_type = @article.article_type.name == "default" ? "factcheck" : "editorial" %>

<article class="full-text">
  <h1><%= @article.title %></h1>
  <p class="lead"><%= raw(@article.perex) %></p>

  <section class="segment">
    <% @article.segments.each do |segment| %>
      <% if segment.is_text? %>
        <%= raw(segment.text) %>
      <% else %>
        <% if @article.segments.size === 1 %>
          <h2 class="filters">Výroky</h2>
        <% end %>

        <% @article.segments.each do |segment| %>
          <% if segment.is_text? %>
            <%= raw(segment.segment.text) %>
          <% else %>
            <%= render(partial: "statement/detail", collection: segment.published_statements, as: :statement) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  </section>

  <% if @users %>
    <%= render(partial: "shared/authors") %>
  <% end %>
</article>

<% if @article_type == "factcheck" %>
  <aside class="meta">
    <p>
      <%= @article.source.medium.name %>
      <% if @article.source.source_url %>
          (<a class="ext" href="<%= @article.source.source_url %>">záznam</a>)
      <% end %>
      <br>
      Moderátor: <%= @article.source.media_personality.name %><br>
      Publikováno <%= raw(l(@article.published_at, format: :long)) %>
    </p>

    <% @article.unique_speakers.each do |speaker| %>
      <%= render(
        partial: "shared/speaker_stat",
        locals: {
          speaker: speaker,
          stats: controller.source_stats.build(@article.source, speaker)
        }) %>
    <% end %>
  </aside>
<% end %>
