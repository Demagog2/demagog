<%
speaker_elastic_filterable_list_presenter = SpeakerElasticFilterableListPresenter.new(params: @params)

content_for(:title, "Přehled politiků a političek")
content_for(:description, "Za svou existenci Demagog.cz už ověřil výroky stovek politiků a političek.")
%>

<section class="section">
  <div
    class="row g-10"
    data-controller="components--filter"
    data-components--filter-content-cols="col col-12 col-lg-8"
    data-components--filter-open-rows="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-10"
    data-components--filter-close-rows="row row-cols-1 row-cols-md-2 row-cols-lg-6 g-10"
    data-components--filter-open-label="Skrýt filtry"
    data-components--filter-close-label="Zobrazit filtry"
    data-components--filter-no-filters-url="<%= speakers_path() %>"
  >
    <div class="col col-12">
      <div class="d-flex">
        <svg class="me-2 mt-1" width="32" height="34" viewBox="0 0 32 34" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M31.9658 8.10096C28.9424 3.38763 23.5425 0.234375 17.3638 0.234375C7.8754 0.234375 0.190735 7.63239 0.190735 16.7614C0.190735 25.8904 7.8754 33.2939 17.3638 33.2939C23.531 33.2939 28.9195 30.1572 31.9487 25.4604L15.7662 16.833L31.9658 8.10096Z" fill="#111827"/>
        </svg>
        <h1 class="display-4 fw-bold m-0 p-0">Přehled politiků a političek</h1>
      </div>

    </div>
    <div class="col col-12 col-lg-4">

      <a class="btn w-100" data-action="click->components--filter#toggle" aria-show="true">
        <span class="text-white" data-target="components--filter.label">Skrýt filtry</span>
      </a>
    </div>
    <div class="col col-12 col-lg-8">
      <div class="d-flex justify-content-end">
        <div class="w-100 mw-350px">
          <input name="q" type="text" class="input outline focus-primary" placeholder="Zadejte hledaný výraz…">
        </div>
      </div>
    </div>
    <div class="col col-12 col-lg-4" data-target="components--filter.filter">
      <div class="bg-light rounded-l p-5">
        <form class="filters-list" data-target="components--filter.filtersForm">
        <% speaker_elastic_filterable_list_presenter.filter_options[:body_id].each do |group| %>
          <div class="accordion w-100 mb-5" data-controller="components--accordion">
            <div
              class="accordion-link d-flex align-items-center justify-content-between w-100 min-h-40px"
              data-target="components--accordion.link"
              data-action="click->components--accordion#toggle"
              aria-show="true"
            >
              <span class="fs-6 fw-bold"><%= group[:group_name] %></span>
              <span class="accordion-icon">
                <svg width="23" height="12" viewBox="0 0 23 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 0.597656L11.646 11.2437L22.2435 0.646237" stroke="#111827"/>
                </svg>
              </span>
            </div>
            <div class="accordion-content" data-target="components--accordion.content">
              <% group[:filter_options].each do |filter_option| %>
              <div class="check-btn py-2">
                <input type="checkbox" name="strana" value="<%= filter_option[:value] %>" <% if filter_option[:selected] %>checked<% end %> data-action="change->components--filter#setFilter">
                <span class="checkmark"></span>
                <span class="small fw-bold me-2"><%= filter_option[:label] %></span>

                <span class="smallest min-w-40px"><%= number_with_delimiter(filter_option[:count], delimiter: " ") %> <%= cs_pluralize(filter_option[:count], "osoba", "osoby", "osob") %></span>
              </div>

              <% end %>
            </div>
          </div>
          <div class="separator bg-dark mb-5"></div>
        <% end %>
        </form>
        <div class="w-100 py-2">
          <a class="btn w-100" href="<%= speakers_path() %>">
            <span class="text-white">Zrušit filtry</span>
          </a>
        </div>
      </div>
    </div>
    <div class="col col-12 col-lg-8" data-target="components--filter.content">
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-10" data-target="components--filter.rows">
        <% if speaker_elastic_filterable_list_presenter.parsed_params_filters.empty? && (@params[:page] == 1 || @params[:page].blank?) %>
          <% speaker_elastic_filterable_list_presenter.president_and_government_speakers.each do |speaker| %>
            <%= render(SpeakerListItemComponent.new(speaker: speaker)) %>
          <% end %>
        <% end %>
        <% speaker_elastic_filterable_list_presenter.paginated_speakers.each do |speaker| %>
          <%= render(SpeakerListItemComponent.new(speaker: speaker)) %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="">
    <%= paginate(speaker_elastic_filterable_list_presenter.paginated_speakers) %>
  </div>
</section>
